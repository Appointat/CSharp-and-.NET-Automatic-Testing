# gRPC - Remote procedure call


# Overview

[gRPC](https://grpc.io/) is a high-performance, open-source framework for building remote procedure call (RPC) APIs. It allows you to define APIs using the Protocol Buffer data format, which provides efficient and fast serialization and deserialization of data. gRPC supports a wide range of programming languages and can run on any platform, making it a popular choice for building scalable and efficient microservices.

# Get started! : C#, Go, C++, Java, Python

## C#/.NET

*This page used to contain the documentation for the original C# implementation of gRPC based on the native gRPC Core library (i.e.Â `Grpc.Core`Â nuget package). The implementation is currently in maintenance mode and its source code has beenÂ [moved](https://github.com/grpc/grpc/blob/master/src/csharp/README.md). We plan to deprecate the implementation in the future (seeÂ [blogpost](https://grpc.io/blog/grpc-csharp-future/)) and we recommend that all users use theÂ [grpc-dotnet](https://github.com/grpc/grpc-dotnet)Â implementation instead. æ­¤é¡µé¢è¿‡å»åŒ…å«åŸºäºåŸç”Ÿ gRPC æ ¸å¿ƒåº“ï¼ˆå³ Grpc.Core nuget åŒ…ï¼‰çš„ gRPC çš„åŸå§‹ C# å®ç°çš„æ–‡æ¡£ã€‚ è¯¥å®æ–½ç›®å‰å¤„äºç»´æŠ¤æ¨¡å¼ï¼Œå…¶æºä»£ç å·²è¢«ç§»åŠ¨ã€‚ æˆ‘ä»¬è®¡åˆ’åœ¨æœªæ¥å¼ƒç”¨è¯¥å®ç°ï¼ˆè¯·å‚é˜…åšå®¢æ–‡ç« ï¼‰ï¼Œæˆ‘ä»¬å»ºè®®æ‰€æœ‰ç”¨æˆ·æ”¹ç”¨ grpc-dotnet å®ç°ã€‚*

The following pages cover the C# implementation of gRPC for .NET ([grpc-dotnet](https://github.com/grpc/grpc-dotnet)):

- [Introduction to gRPC on .NET Core](https://docs.microsoft.com/aspnet/core/grpc)
- [Tutorial: Create a gRPC client and server in ASP.NET Core](https://docs.microsoft.com/aspnet/core/tutorials/grpc/grpc-start)

Several sample applications are available from theÂ [examples](https://github.com/grpc/grpc-dotnet/tree/master/examples)Â folder in theÂ [grpc-dotnet](https://github.com/grpc/grpc-dotnet)Â repository.

# Overview of gRPC on .NET

[gRPC](https://grpc.io/)Â is a **language-agnosticè¯­è¨€æ— å…³**, high-performance Remote Procedure Call (RPC) framework.

The **main benefits of gRPC** are:

- Modern, high-performance, lightweight RPC framework.
- Contract-first API development, using Protocol Buffers by default, allowing for language-agnostic implementations.
- Tooling is available for many languages to generate strongly-typed servers and clients.
- Supports client, server, and bi-directional streaming calls.
- Reduced network usage with Protobuf binary serialization.

**These benefits make gRPC ideal for:**

- Lightweight microservices where efficiency is critical.
- Polyglot systems where multiple languages are required for the development.
- Point-to-point real-time services that need to handle streaming requests or responses.

## ****C# Tooling support forÂ `.proto`Â files****

gRPC uses a contract-firstå¥‘çº¦ä¼˜å…ˆ approach to API development. Services and messages are defined inÂ `.proto` files:

```protobuf
syntax = "proto3";

service Greeter {
	rpc SayHello (HelloRequest) returns (HelloReply);
}

message HelloRequest {
	string name = 1;
}

message HelloReply {
	string message = 1;
}
```

.NET types for services, clients, and messages are automatically generated by including `.proto` files in a project:

- Add a package reference toÂ [Grpc.Tools](https://www.nuget.org/packages/Grpc.Tools/)Â package.
- Add `.proto` files to the `<Protobuf>` item group.

```xml
<ItemGroup>
	<Protobuf Include = "Protos\greet.proto" />
</ItemGroup>
```

For more information on gRPC tooling support, seeÂ [gRPC services with C#](https://learn.microsoft.com/en-us/aspnet/core/grpc/basics?view=aspnetcore-7.0).

## ****gRPC services on ASP.NET Core****

gRPC services can be hosted on ASP.NET Core. Services have full integration with ASP.NET Core features such as logging, dependency injection (DI), authentication, and authorization.

### ****Add gRPC services to an ASP.NET Core app****

gRPC requires theÂ [Grpc.AspNetCore](https://www.nuget.org/packages/Grpc.AspNetCore)Â package. For information on configuring gRPC in a .NET app, seeÂ [Configure gRPC](https://learn.microsoft.com/en-us/aspnet/core/grpc/aspnetcore?view=aspnetcore-7.0#configure-grpc).

### The gRPC service project template

The [ASP.NET](http://ASP.NET) Core gRPC Service project template provides a starter service:

```csharp
public class GreeterService : Greeter.GreeterBase
{
	private readonly ILogger<GreeterService> _logger;
	public GreeterService(ILogger<GreeterService> logger;
	{
		_logger = logger;
	}

	public override Task<HelloReply> SayHello(HelloRequest request, ServerCallContext context)
	{
		_logger.LogInformation("Saying hello to {Name}", request.Name);
		return Task.FromResult(new HelloReply 
		{
			Message = "Hello" + request.Name
		});
	}
}
```

`GreeterService`Â inherits from theÂ `GreeterBase`Â type, which is generated from theÂ `Greeter`Â service in theÂ `.proto`Â file. The service is made accessible to clients inÂ `Program.cs` :

```csharp
app.MapGrpcService<GreeterService>();
```

To learn more about gRPC services on ASP.NET Core, seeÂ [gRPC services with ASP.NET Core](https://learn.microsoft.com/en-us/aspnet/core/grpc/aspnetcore?view=aspnetcore-7.0).

### Call gRPC services with a .NET client

gRPC clients are concrete client types that areÂ [generated fromÂ `.proto`Â files](https://learn.microsoft.com/en-us/aspnet/core/grpc/basics?view=aspnetcore-7.0#generated-c-assets). The concrete gRPC client has methods that translate to the gRPC service in theÂ `.proto`Â file.

```csharp
var channel = GrpcChannel.ForAddresse("https://localhost:5001");
var client = new Greeter.GreeterClient(channel);

var response = await client.SayHelloAsync(
	new HelloRequest { Name = "World" });

Console.WriteLine(response.Message);
```

A gRPC client is created using a channel, which represents a long-lived connection to a gRPC service. A channel can be created usingÂ `GrpcChannel.ForAddress`.

For more information on creating clients, and calling different service methods, seeÂ [Call gRPC services with the .NET client](https://learn.microsoft.com/en-us/aspnet/core/grpc/client?view=aspnetcore-7.0).

### Additional resources

- [gRPC services with C#](https://learn.microsoft.com/en-us/aspnet/core/grpc/basics?view=aspnetcore-7.0)
- [gRPC services with ASP.NET Core](https://learn.microsoft.com/en-us/aspnet/core/grpc/aspnetcore?view=aspnetcore-7.0)
- [Call gRPC services with the .NET client](https://learn.microsoft.com/en-us/aspnet/core/grpc/client?view=aspnetcore-7.0)
- [gRPC client factory integration in .NET](https://learn.microsoft.com/en-us/aspnet/core/grpc/clientfactory?view=aspnetcore-7.0)
- [Create a .NET Core gRPC client and server in ASP.NET Core](https://learn.microsoft.com/en-us/aspnet/core/tutorials/grpc/grpc-start?view=aspnetcore-7.0)
<<<<<<< HEAD

# Tutorial: Create a gRPC client and server in [ASP.NET](http://ASP.NET) Core

## Summary

- Prerequisites å…ˆå†³æ¡ä»¶
- Create a gRPC service
- Create the gRPC client in a .Net console app
- Test the gRPC client with the gRPC Greater service

This tutorial shows how to create a .NET CoreÂ [gRPC](https://learn.microsoft.com/en-us/aspnet/core/grpc/?view=aspnetcore-7.0)Â client and an ASP.NET Core gRPC Server. At the end, **you'll have a gRPC client that communicates with the gRPC Greeter service**.

In this tutorial, you:

- Create a gRPC Server.
- Create a gRPC client.
- Test the gRPC client with the gRPC Greeter service

## Prerequisites

| Visual Studio | Visual Studio Code | Visual Studio for Mac |
| --- | --- | --- |
| â€¢ https://visualstudio.microsoft.com/vs/#downloadÂ with theÂ ASP.NET and web developmentÂ workload. | - Visual Studio Code
- C# for Visual Studio Code (latest version)
- .NET 6.0 SDK | â€¢ https://visualstudio.microsoft.com/vs/mac/preview/ |

## Create a gRPC service

- Visual Studio
    - Start Visual Studio 2022 and selectÂ **Create a new project**.
    - In theÂ **Create a new project**Â dialog, search forÂ `gRPC`. SelectÂ **ASP.NET Core gRPC Service**Â and selectÂ **Next**.
    - In theÂ **Configure your new project**Â dialog, enterÂ `GrpcGreeter`Â forÂ **Project name**. It's important to name the projectÂ *GrpcGreeter*Â so the namespaces match when you copy and paste code.
    - SelectÂ **Next**.
    - In theÂ **Additional information**Â dialog, selectÂ **.NET 6.0 (Long-term support)**Â and then selectÂ **Create**.
- Visual Studio Code
    - The tutorial assumes familiarity with VS Code. For more information, seeÂ [Getting started with VS Code](https://code.visualstudio.com/docs)
        - Open theÂ [integrated terminal](https://code.visualstudio.com/docs/editor/integrated-terminal).
        - Change to the directory (`cd`) that will contain the project.
        - Run the following commands:
            
            ```csharp
            dotnet new grpc -o GrpcGreeter
            code -r GrpcGreeter
            ```
            
            - TheÂ `dotnet new`Â command creates a new gRPC service in theÂ *GrpcGreeter*Â folder.
            - TheÂ `code`Â command opens theÂ *GrpcGreeter*Â folder in a new instance of Visual Studio Code.
- Visual Studio for Mac
    - Start Visual Studio for Mac and selectÂ **File**Â >Â **New Project**.
    - In theÂ **Choose a template for your new project**Â dialog, selectÂ **Web and Console**Â >Â **App**Â >Â **gRPC Service**Â and selectÂ **Continue**.
    - SelectÂ **.NET 6.0**Â for the target framework and selectÂ **Continue**.
    - Name the projectÂ **GrpcGreeter**. It's important to name the projectÂ *GrpcGreeter*Â so the namespaces match when you copy and paste code.
    - SelectÂ **Continue**.

### Run the service (Visual Studio)

- Press Ctrl+F5 to run without the debugger.
    
    Visual Studio displays the following dialog when a project is not yet configured to use SSL:
    
    ![trustcert.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/61b53810-717b-4e41-97ed-a5e22699d6fe/trustcert.png)
    
- SelectÂ **Yes**Â if you trust the IIS Express SSL certificate.
    
    The following dialog is displayed: 
    
    ![cert.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1f9da507-f009-4eaf-bb3d-2de5629f7dbc/cert.png)
    
    SelectÂ **Yes**Â if you agree to trust the development certificate.
    
    For information on trusting the Firefox browser, seeÂ [Firefox SEC_ERROR_INADEQUATE_KEY_USAGE certificate error](https://learn.microsoft.com/en-us/aspnet/core/security/enforcing-ssl?view=aspnetcore-7.0#trust-ff).
    
    Visual Studio:
    
    - StartsÂ [Kestrel](https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/?view=aspnetcore-7.0#kestrel)Â server.
    - Launches a browser.
    - Navigates toÂ `http://localhost:port`, such asÂ `http://localhost:7042`.
        - *port*: A randomly assigned port number for the app.
        - `localhost`: The standard hostname for the local computer. Localhost only serves web requests from the local computer.

The logs show the service listening onÂ `https://localhost:<port>`, whereÂ `<port>`Â is the localhost port number randomly assigned when the project is created and set inÂ `Properties/launchSettings.json`.

```powershell
info: Microsoft.Hosting.Lifetime[0]
      Now listening on: https://localhost:<port>
info: Microsoft.Hosting.Lifetime[0]
      Application started. Press Ctrl+C to shut down.
info: Microsoft.Hosting.Lifetime[0]
      Hosting environment: Development
```

> ğŸ—’ï¸ Note
> 
> 
> The gRPC template is configured to useÂ **[Transport Layer Security (TLS)](https://tools.ietf.org/html/rfc5246)**. gRPC clients need to use HTTPS to call the server. The gRPC service localhost port number is randomly assigned when the project is created and set in theÂ *Properties\launchSettings.json*Â file of the gRPC service project.
> 
> macOS doesn't support ASP.NET Core gRPC with TLS. Additional configuration is required to successfully run gRPC services on macOS. For more information, seeÂ **[Unable to start ASP.NET Core gRPC app on macOS](https://learn.microsoft.com/en-us/aspnet/core/grpc/troubleshoot?view=aspnetcore-7.0#unable-to-start-aspnet-core-grpc-app-on-macos)**.
> 

### Examine the project files

*GrpcGreeter*Â project files:

- `Protos/greet.proto`: defines theÂ `Greeter`Â gRPC and is used to generate the gRPC server assets. For more information0, seeÂ [Introduction to gRPC](https://learn.microsoft.com/en-us/aspnet/core/grpc/?view=aspnetcore-7.0).
- `Services`Â folder: Contains the implementation of theÂ `Greeter`Â service.
- `appSettings.json`: Contains configuration data such as the protocol used by Kestrel. For more information, seeÂ [Configuration in ASP.NET Core](https://learn.microsoft.com/en-us/aspnet/core/fundamentals/configuration/?view=aspnetcore-7.0).
- `Program.cs`, which contains:
    - The entry point for the gRPC service. For more information, seeÂ [.NET Generic Host in ASP.NET Core](https://learn.microsoft.com/en-us/aspnet/core/fundamentals/host/generic-host?view=aspnetcore-7.0).
    - Code that configures app behavior. For more information, seeÂ [App startup](https://learn.microsoft.com/en-us/aspnet/core/fundamentals/startup?view=aspnetcore-7.0).

## Create the gRPC client in a .NET console app (Visual Studio)

- Open a second instance of Visual Studio and selectÂ **Create a new project**.
- In theÂ **Create a new project**Â dialog, selectÂ **Console Application**, and selectÂ **Next**.
- In theÂ **Project name**Â text box, enterÂ **GrpcGreeterClient**Â and selectÂ **Next**.
- In theÂ **Additional information**Â dialog, selectÂ **.NET 6.0 (Long-term support)**Â and then selectÂ **Create**.

### Add required NuGet packages (Visual Studio)

The gRPC client project requires the following NuGet packages:

- [Grpc.Net.Client](https://www.nuget.org/packages/Grpc.Net.Client), which contains the .NET Core client.
- [Google.Protobuf](https://www.nuget.org/packages/Google.Protobuf/), which contains protobuf message APIs for C#.
- [Grpc.Tools](https://www.nuget.org/packages/Grpc.Tools/), which contain C# tooling support for protobuf files. The tooling package isn't required at runtime, so the dependency is marked withÂ `PrivateAssets="All"`.

Install the packages using either the Package Manager Console (PMC) or Manage NuGet Packages.

### PMC option to install packages

- From Visual Studio, selectÂ **Tools**Â >Â **NuGet Package Manager**Â >Â **Package Manager Console**
- From theÂ **Package Manager Console**Â window, runÂ `cd GrpcGreeterClient`Â to change directories to the folder containing theÂ `GrpcGreeterClient.csproj`Â files.
- Run the following commands:
    
    ```powershell
    Install-Package Grpc.Net.Client
    Install-Package Google.Protobuf
    Install-Package Grpc.Tools
    ```
    

### Manage NuGet Packages option to install packages

- Right-click the project inÂ **Solution Explorer**Â >Â **Manage NuGet Packages**.
- Select theÂ **Browse**Â tab.
- EnterÂ **Grpc.Net.Client**Â in the search box.
- Select theÂ **Grpc.Net.Client**Â package from theÂ **Browse**Â tab and selectÂ **Install**.
- Repeat forÂ `Google.Protobuf`Â andÂ `Grpc.Tools`.

### Add greet.proto

- Create a ********Protos******** folder in the gRPC client project.
- Copy the *****Protos\greet.proto***** file from the gRPC Greeter service to the ***Protos*** folder in the gRPC client project.
- Update the namespace inside the `greet.proto` file to the projectâ€™s namespaces:
    
    ```powershell
    option csharp_namespace = "GrpcGreetrClient";
    ```
    
- Edit the `GrpcGreeterClient.csproj` project file:
    
    Right-click the project and selectÂ **Edit Project File**.
    
    - Add an item group with aÂ `<Protobuf>`Â element that refers to theÂ *greet.proto*Â file, then add aÂ `<Protobuf>`Â element to the existingÂ `<ItemGroup>`Â in the project file:
        
        ```xml
        <ItemGroup>
            <Protobuf Include="Protos\\greet.proto" GrpcService="Client" />
        </ItemGroup>
        ```
        
    - Add aÂ `<PackageReference>`Â element to the existingÂ `<ItemGroup>`Â in the project file:
        
        ```xml
        <ItemGroup>
            <PackageReference Include="Grpc.Tools" Version="2.30.0" PrivateAssets="All" />
        </ItemGroup>
        ```
        

### Create the Greeter client

- Build the client project to create the types in theÂ `GrpcGreeterClient`Â  namespace.
- Create a `Program.cs`Â file in theÂ `GrpcGreeterClient`Â project.
- Add the following code to theÂ `GreeterClient.cs`Â file:

```csharp
using System.Threading.Tasks;
using Grpc.Net.Client;
using GrpcGreeterClient;

// The port number must match the port of the gRPC server.
using var channel = GrpcChannel.ForAddress("https://localhost:7042");
var client = new Greeter.GreeterClient(channel);
var reply = await client.SayHelloAsync(
	new HelloRequest { Name = "GreeterClient" });
Console.WriteLine("Greeting: " + reply.Message);
Console.WriteLine("Press any key to exit...");
COnsole.ReadKey();
```

- In the preceding highlighted code, replace the localhost port numberÂ `7042`Â with theÂ `HTTPS`Â port number specified inÂ `Properties/launchSettings.json`Â within theÂ `GrpcGreeter`Â service project.

`Program.cs` contains the entry point and logic for the gRPC client.

The Greeter client is created by:

- Instantiating a `GrpcChannel` containing the information for creating the connection to the gRPC service.
- Using the `GrpcChannel` to construct the Greeter client:
    
    ```csharp
    // The port number must match the port of the gRPC server.
    using var channel = GrpcChannel.ForAddress("https://localhost:7042");
    var client = new Greeter.GreeterClient(channel);
    var reply = await client.SayHelloAsync(
                      new HelloRequest { Name = "GreeterClient" });
    Console.WriteLine("Greeting: " + reply.Message);
    Console.WriteLine("Press any key to exit...");
    Console.ReadKey();
    ```
    

The Greeter client calls the asynchronousÂ `SayHello`Â method. The result of theÂ `SayHello`Â call is displayed:

```csharp
// The port number must match the port of the gRPC server.
using var channel = GrpcChannel.ForAddress("https://localhost:7042");
var client = new Greeter.GreeterClient(channel);
var reply = await client.SayHelloAsync(
                  new HelloRequest { Name = "GreeterClient" });
Console.WriteLine("Greeting: " + reply.Message);
Console.WriteLine("Press any key to exit...");
Console.ReadKey();
```

## Test the gRPC client with the gRPC Greater service (Visual Studio)

- In the Greeter service, pressÂ `Ctrl+F5`Â to start the server without the debugger.
- In theÂ `GrpcGreeterClient`Â project, pressÂ `Ctrl+F5`Â to start the client without the debugger.

The client sends a greeting to the service with a message containing its name,Â *GreeterClient*
. The service sends the message "Hello GreeterClient" as a response. The "Hello GreeterClient" response is displayed in the command prompt:

```
Greeting: Hello GreeterClient
Press any key to exit...
```

The gRPC service records the details of the successful call in the logs written to the command prompt:

```
info: Microsoft.Hosting.Lifetime[0]
      Now listening on: https://localhost:<port>
info: Microsoft.Hosting.Lifetime[0]
      Application started. Press Ctrl+C to shut down.
info: Microsoft.Hosting.Lifetime[0]
      Hosting environment: Development
info: Microsoft.Hosting.Lifetime[0]
      Content root path: C:\GH\aspnet\docs\4\Docs\aspnetcore\tutorials\grpc\grpc-start\sample\GrpcGreeter
info: Microsoft.AspNetCore.Hosting.Diagnostics[1]
      Request starting HTTP/2 POST https://localhost:<port>/Greet.Greeter/SayHello application/grpc
info: Microsoft.AspNetCore.Routing.EndpointMiddleware[0]
      Executing endpoint 'gRPC - /Greet.Greeter/SayHello'
info: Microsoft.AspNetCore.Routing.EndpointMiddleware[1]
      Executed endpoint 'gRPC - /Greet.Greeter/SayHello'
info: Microsoft.AspNetCore.Hosting.Diagnostics[2]
      Request finished in 78.32260000000001ms 200 application/grpc
```

Update theÂ `appsettings.Development.json`Â file by adding the following lines:

```
"Microsoft.AspNetCore.Hosting": "Information",
"Microsoft.AspNetCore.Routing.EndpointMiddleware": "Information"
```

# ****Next steps****

- View or downloadÂ [the completed sample code for this tutorial](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/tutorials/grpc/grpc-start/sample6)Â ([how to download](https://learn.microsoft.com/en-us/aspnet/core/introduction-to-aspnet-core?view=aspnetcore-7.0#how-to-download-a-sample)).
- [Overview for gRPC on .NET](https://learn.microsoft.com/en-us/aspnet/core/grpc/?view=aspnetcore-7.0)
- [gRPC services with C#](https://learn.microsoft.com/en-us/aspnet/core/grpc/basics?view=aspnetcore-7.0)
- [Migrate gRPC from C-core to gRPC for .NET](https://learn.microsoft.com/en-us/aspnet/core/grpc/migration?view=aspnetcore-7.0)
